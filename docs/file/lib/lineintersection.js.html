<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">lib/lineintersection.js | optimum</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Projet Optimum"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="optimum"><meta property="twitter:description" content="Projet Optimum"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/arc.js~Arc.html">Arc</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/astree.js~ASTree.html">ASTree</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/astreesectors.js~ASTreeSectors.html">ASTreeSectors</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/cluster.js~Cluster.html">Cluster</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/dual.js~Dual.html">Dual</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/dualrtree.js~DualRtree.html">DualRtree</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/heatmap.js~HeatMap.html">HeatMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/isovistsectors2d.js~IsoVist.html">IsoVist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/isovistsectors3d.js~IsoVist3D.html">IsoVist3D</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/picture.js~Picture.html">Picture</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/plane.js~Plane.html">Plane</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/polardual.js~PolarDual.html">PolarDual</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/sector.js~Sector.html">Sector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/vectorlayercolormap.js~VectorLayerColormap.html">VectorLayerColormap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/vectorlayercolormaprenderer.js~VectorLayerColormapRenderer.html">VectorLayerColormapRenderer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sectorsStEtienne">sectorsStEtienne</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sectorsStEtienne2345_r1500">sectorsStEtienne2345_r1500</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sectorsStEtienne2345_r300">sectorsStEtienne2345_r300</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-euclideanDistance">euclideanDistance</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-computeAlphaOmegaFromDir">computeAlphaOmegaFromDir</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-convertMetadataToJSON">convertMetadataToJSON</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createPositionArray">createPositionArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getOrientation">getOrientation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getPosition">getPosition</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lonLatToDecimal">lonLatToDecimal</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-angleToVector">angleToVector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-bboxArrayToObject">bboxArrayToObject</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-boundingBox">boundingBox</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-cartesianToSpherical">cartesianToSpherical</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-centerOfMass">centerOfMass</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-intersectionLinePlane">intersectionLinePlane</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-planeFromThreePoints">planeFromThreePoints</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-project">project</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sphericalToCartesian">sphericalToCartesian</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-vectorToAngle">vectorToAngle</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-changeLayout">changeLayout</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fillGrid">fillGrid</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-filter">filter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateGrid">generateGrid</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-loadImageAndFillGrid">loadImageAndFillGrid</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-halfLineAndLineIntersection">halfLineAndLineIntersection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-halfLineIntersection">halfLineIntersection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-halfLinesIntersect">halfLinesIntersect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lineIntersection">lineIntersection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-onSegment">onSegment</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-rectangleContains">rectangleContains</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-rectanglesIntersect">rectanglesIntersect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-segmentIntersection">segmentIntersection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-segmentIntersectionExact">segmentIntersectionExact</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-segmentsEqual">segmentsEqual</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-segmentsIntersect">segmentsIntersect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setEpsilon">setEpsilon</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-addRandomArcs">addRandomArcs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-addRandomLocations">addRandomLocations</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getRandomArbitrary">getRandomArbitrary</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getBuildingSegments">getBuildingSegments</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-pollDB">pollDB</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-pollImages">pollImages</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-pollIsovist">pollIsovist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-pollThumbnails">pollThumbnails</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-segmentsFromXMLRequest">segmentsFromXMLRequest</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createCircleOutOverlay">createCircleOutOverlay</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createNewImage">createNewImage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-gradient">gradient</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setStyleArcs">setStyleArcs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setStyleClusters">setStyleClusters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setStyleInput">setStyleInput</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setStylePolygonColormapIsovist">setStylePolygonColormapIsovist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setStylePolygonIsovist">setStylePolygonIsovist</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setStyleTopo">setStyleTopo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-arcs">arcs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-clusterSource">clusterSource</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-imageStatic">imageStatic</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-inputLineSource">inputLineSource</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-inputLines">inputLines</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-lineSource">lineSource</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-lines">lines</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-olClusters">olClusters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-onClickGroup">onClickGroup</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-overlay">overlay</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-overlayGroup">overlayGroup</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-polygonSource">polygonSource</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-source">source</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-thumbnails">thumbnails</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-vectorLayerArc">vectorLayerArc</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-vectorLayerColormap">vectorLayerColormap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-epsilon">epsilon</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-pointRadius">pointRadius</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-stylesTopo">stylesTopo</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#clustering">clustering</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/clustering/clusteringstrategy.js~ClusteringStrategy.html">ClusteringStrategy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/clustering/dendrogramstrategy.js~DistanceStrategy.html">DistanceStrategy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/clustering/distancestrategy.js~DistanceStrategy.html">DistanceStrategy</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">lib/lineintersection.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/**
 * @fileOverview Intersections between shapes
 * @name lineintersection.js
 * @author Florent Gr&#xE9;lard
 * @license
 */
import bigdecimal from &apos;bigdecimal&apos;;

/**
 * Error tolerance epsilon
 * @type {number}
 */
export var epsilon = 0.000001;

/**
 * Change the value of {@link epsilon}
 * @param {number} eps
 */
export function setEpsilon(eps) {
    epsilon = eps;
}

/**
 * Checks if number b is in the interval [a, c+epsilon]
 * @param {Number} a lower bound
 * @param {Number} b value to check
 * @param {Number} c upper bound
 * @returns {Boolean} Between coordinates
 */
function between(a, b, c) {
    return a-epsilon &lt;= b &amp;&amp; b &lt;= c+epsilon;
}


/**
 * Mean absolute difference of b between a and c
 * @param {number} a first value
 * @param {number} b value to check
 * @param {number} c second value
 * @returns {number} mean absolute difference
 */
function averageDiff(a, b, c) {
    return (Math.abs(a - b) + Math.abs(c - b)) / 2;
}


/**
 * Exact Intersection segment
 * @param {number} x1 First segment first point x
 * @param {number} y1 First segment first point y
 * @param {number} x2 First segment second point x
 * @param {number} y2 First segment second point y
 * @param {number} x3 Second segment first point x
 * @param {number} y3 Second segment first point y
 * @param {number} x4 Second segment second point x
 * @param {number} y4 Second segment second point y
 * @returns {Boolean|{x,y}} the intersection, if it exists
 */
export function segmentIntersectionExact(x1,y1,x2,y2, x3,y3,x4,y4) {
    var bx1 = bigdecimal.BigDecimal(x1.toString());
    var bx2 = bigdecimal.BigDecimal(x2.toString());
    var bx3 = bigdecimal.BigDecimal(x3.toString());
    var bx4 = bigdecimal.BigDecimal(x4.toString());
    var by1 = bigdecimal.BigDecimal(y1.toString());
    var by2 = bigdecimal.BigDecimal(y2.toString());
    var by3 = bigdecimal.BigDecimal(y3.toString());
    var by4 = bigdecimal.BigDecimal(y4.toString());

    var x1y2 = bx1.multiply(by2);
    var y1x2 = by1.multiply(bx2);
    var x3x4 = bx3.subtract(bx4);
    var x1x2 = bx1.subtract(bx2);
    var x3y4 = bx3.multiply(by4);
    var y3x4 = by3.multiply(bx4);
    var y3y4 = by3.subtract(by4);
    var y1y2 = by1.subtract(by2);


    var detX12 = (x1y2.subtract(y1x2)).multiply(x3x4);
    var detX34 = (x3y4.subtract(y3x4)).multiply(x1x2);
    var detV = (x1x2.multiply(y3y4)).subtract((y1y2.multiply(x3x4)));

    var detY12 = (x1y2.subtract(y1x2)).multiply(y3y4);
    var detY34 = (x3y4.subtract(y3x4)).multiply(y1y2);


    var x = ((detX12.subtract(detX34)).divide(detV, 0)).floatValue();

    var y = ((detY12.subtract(detY34)).divide(detV, 0)).floatValue();

    if (isNaN(x)||isNaN(y)) {
        return false;
    } else {
        if (x1&gt;=x2) {
            if (!between(x2, x, x1)) {return false;}
        } else {
            if (!between(x1, x, x2)) {return false;}
        }
        if (y1&gt;=y2) {
            if (!between(y2, y, y1)) {return false;}
        } else {
            if (!between(y1, y, y2)) {return false;}
        }
        if (x3&gt;=x4) {
            if (!between(x4, x, x3)) {return false;}
        } else {
            if (!between(x3, x, x4)) {return false;}
        }
        if (y3&gt;=y4) {
            if (!between(y4, y, y3)) {return false;}
        } else {
            if (!between(y3, y, y4)) {return false;}
        }
    }

    return {x: x,y: y};
}


/**
 * Intersection segment
 * @param {number} x1 First segment first point x
 * @param {number} y1 First segment first point y
 * @param {number} x2 First segment second point x
 * @param {number} y2 First segment second point y
 * @param {number} x3 Second segment first point x
 * @param {number} y3 Second segment first point y
 * @param {number} x4 Second segment second point x
 * @param {number} y4 Second segment second point y
 * @returns {Boolean|{x,y}} the intersection, if it exists
 */
export function segmentIntersection(x1,y1,x2,y2, x3,y3,x4,y4) {
    var x=((x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4)) /
            ((x1-x2)*(y3-y4)-(y1-y2)*(x3-x4));
    var y=((x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4)) /
        ((x1-x2)*(y3-y4)-(y1-y2)*(x3-x4));
    if (isNaN(x)||isNaN(y)) {
        return false;
    } else {
        if (x1&gt;=x2) {
            if (!between(x2, x, x1)) {return false;}
        } else {
            if (!between(x1, x, x2)) {return false;}
        }
        if (y1&gt;=y2) {
            if (!between(y2, y, y1)) {return false;}
        } else {
            if (!between(y1, y, y2)) {return false;}
        }
        if (x3&gt;=x4) {
            if (!between(x4, x, x3)) {return false;}
        } else {
            if (!between(x3, x, x4)) {return false;}
        }
        if (y3&gt;=y4) {
            if (!between(y4, y, y3)) {return false;}
        } else {
            if (!between(y3, y, y4)) {return false;}
        }
    }
    return {x: x,y: y};
}

/**
 * Intersection line
 * @param {number} x1 First segment first point x
 * @param {number} y1 First segment first point y
 * @param {number} x2 First segment second point x
 * @param {number} y2 First segment second point y
 * @param {number} x3 Second segment first point x
 * @param {number} y3 Second segment first point y
 * @param {number} x4 Second segment second point x
 * @param {number} y4 Second segment second point y
 * @returns {Boolean|{x,y}} the intersection, if it exists
 */
export function lineIntersection(x1,y1,x2,y2, x3,y3,x4,y4) {
    var x=((x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4)) /
            ((x1-x2)*(y3-y4)-(y1-y2)*(x3-x4));
    var y=((x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4)) /
        ((x1-x2)*(y3-y4)-(y1-y2)*(x3-x4));
    if (isNaN(x)||isNaN(y)) {
        return false;
    }
    return {x: x,y: y};
}



/**
* Intersection half-line and line
 * @param {number} x1 First segment first point x
 * @param {number} y1 First segment first point y
 * @param {number} x2 First segment second point x
 * @param {number} y2 First segment second point y
 * @param {number} x3 Second segment first point x
 * @param {number} y3 Second segment first point y
 * @param {number} x4 Second segment second point x
 * @param {number} y4 Second segment second point y
 * @returns {Boolean|{x,y}} the intersection, if it exists
 */
export function halfLineAndLineIntersection(x1,y1,x2,y2, x3,y3,x4,y4) {
    var intersection = lineIntersection(x1,y1,x2,y2, x3,y3,x4,y4);
    if (!intersection) return false;
    var x = intersection.x;
    var y = intersection.y;
    if (x1&gt;=x2) {
        if (x &gt; x1) {return false;}
    } else {
        if (x &lt; x1) {return false;}
    }
    if (y1&gt;=y2) {
        if (y &gt; y1) {return false;}
    } else {
        if (y &lt; y1) {return false;}
    }
    return {x: x,y: y};
}

/**
 * Intersection half line
 * @param {number} x1 First segment first point x
 * @param {number} y1 First segment first point y
 * @param {number} x2 First segment second point x
 * @param {number} y2 First segment second point y
 * @param {number} x3 Second segment first point x
 * @param {number} y3 Second segment first point y
 * @param {number} x4 Second segment second point x
 * @param {number} y4 Second segment second point y
 * @returns {Boolean|{x,y}} the intersection, if it exists
 */
export function halfLineIntersection(x1,y1,x2,y2, x3,y3,x4,y4) {
    var obj = halfLineAndLineIntersection(x1,y1,x2,y2, x3,y3,x4,y4);
    if (!obj) return false;
    var x=obj.x;
    var y=obj.y;
    if (x3&gt;=x4) {
        if (x &gt; x3) {return false;}
    } else {
        if (x &lt; x3) {return false;}
    }
    if (y3&gt;=y4) {
        if (y &gt; y3) {return false;}
    } else {
        if (y &lt; y3) {return false;}
    }
    return {x: x,y: y};
}


/**
 * Helper function to check if there is intersection between two segments represented as linestring objects
 * @param {ol.geom.LineString} s1 first linestring segment
 * @param {ol.geom.LineString} s2 second linestring segment
 * @returns {Boolean|{x,y}} the intersection, if it exists
 */
export function segmentsIntersect(s1, s2) {
    var pS1F = s1.getFirstCoordinate();
    var pS1L = s1.getLastCoordinate();
    var pS2F = s2.getFirstCoordinate();
    var pS2L = s2.getLastCoordinate();


    var intersection = segmentIntersection(pS1F[0], pS1F[1],
                                           pS1L[0], pS1L[1],
                                           pS2F[0], pS2F[1],
                                           pS2L[0], pS2L[1]);
    return intersection;
}

/**
 * Helper function to check if there is intersection between two half lines represented as linestring objects where first coordinate is the start of the half line
 * @param {ol.geom.LineString} s1 first linestring half lines
 * @param {ol.geom.LineString} s2 second linestring half lines
 * @returns {Boolean|{x,y}} the intersection, if it exists
 */
export function halfLinesIntersect(s1, s2) {
    var pS1F = s1.getFirstCoordinate();
    var pS1L = s1.getLastCoordinate();
    var pS2F = s2.getFirstCoordinate();
    var pS2L = s2.getLastCoordinate();


    var intersection = halfLineIntersection(pS1F[0], pS1F[1],
                                           pS1L[0], pS1L[1],
                                           pS2F[0], pS2F[1],
                                           pS2L[0], pS2L[1]);
    return intersection;
}

/**
 * Checks whether a point belongs to a segment
 * @param {Array&lt;number&gt;} p the point
 * @param {ol.geom.LineString} s the segment
 * @returns {boolean} whether p belongs to s
 */
export function onSegment(p, s) {
    var p1 = s.getFirstCoordinate();
    var p2 = s.getLastCoordinate();

    var x1 = p1[0];
    var x2 = p2[0];
    var y1 = p1[1];
    var y2 = p2[1];

    var x = p[0];
    var y = p[1];

    if (x1 &lt; x2) {
        if (!between(x1, x, x2)) return false;
    }
    else {
        if (!between(x2, x, x1)) return false;
    }

    if (y1 &lt; y2) {
        if (!between(y1, y, y2)) return false;
    }
    else {
        if (!between(y2, y, y1)) return false;
    }

    return true;
}


/**
 * Checks whether two segments have the same coordinates
 * @param {ol.geom.LineString} s1
 * @param {ol.geom.LineString} s2
 * @returns {boolean} whether the segments are the same
 */
export function segmentsEqual(s1, s2) {
    return (s1.getFirstCoordinate()[0] === s2.getFirstCoordinate()[0] &amp;&amp;
            s1.getFirstCoordinate()[1] === s2.getFirstCoordinate()[1] &amp;&amp;
            s1.getLastCoordinate()[0] === s2.getLastCoordinate()[0] &amp;&amp;
            s1.getLastCoordinate()[1] === s2.getLastCoordinate()[1]);
}

/**
 * Checks whether two rectangles intersect, that is to say they overlap
 * @param {Object} a
 * @param {Object} b
 * @returns {boolean} whether rectangles intersect
 */
export function rectanglesIntersect(a, b) {
    var x = Math.max(a.minX, b.minX);
    var num1 = Math.min(a.maxX, b.maxX);
    var y = Math.max(a.minY, b.minY);
    var num2 = Math.min(a.maxY, b.maxY);
    if (num1 &gt;= x &amp;&amp; num2 &gt;= y)
        return {minX: x, minY: y, maxX: num1, maxY:num2};
    else
        return false;
}

/**
 * Checks whether a rectangle is entirely contained inside another rectangle
 * @param {Array&lt;number&gt;} r1
 * @param {Array&lt;number&gt;} r2
 * @returns {boolean} whether r2 is entirely contained in r1
 */
export function rectangleContains(r1, r2) {
    var r1minX = r1[0];
    var r1minY = r1[1];
    var r1maxX = r1[2];
    var r1maxY = r1[3];

    var r2minX = r2[0];
    var r2minY = r2[1];
    var r2maxX = r2[2];
    var r2maxY = r2[3];

    return (r2minX &gt;= r1minX &amp;&amp; r2minX &lt;= r1maxX &amp;&amp;
            r2maxX &gt;= r1minX &amp;&amp; r2maxX &lt;= r1maxX &amp;&amp;
            r2minY &gt;= r1minY &amp;&amp; r2minY &lt;= r1maxY &amp;&amp;
            r2maxY &gt;= r1minY &amp;&amp; r2maxY &lt;= r1maxY);
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
